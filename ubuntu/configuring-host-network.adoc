---
permalink: ubuntu/configuring-host-network.html 
sidebar: sidebar 
keywords: how to configure ubuntu or debian host network 
summary: 호스트에서 Linux 설치를 완료한 후에는 나중에 배포할 StorageGRID 노드에 매핑하는 데 적합한 각 호스트의 네트워크 인터페이스 세트를 준비하기 위해 몇 가지 추가 구성을 수행해야 할 수도 있습니다. 
---
= 호스트 네트워크 구성(Ubuntu 또는 Debian)
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
호스트에서 Linux 설치를 완료한 후에는 나중에 배포할 StorageGRID 노드에 매핑하는 데 적합한 각 호스트의 네트워크 인터페이스 세트를 준비하기 위해 몇 가지 추가 구성을 수행해야 할 수도 있습니다.

.시작하기 전에
* 당신은 검토했습니다link:../network/index.html["StorageGRID 네트워킹 가이드라인"] .
* 당신은에 대한 정보를 검토했습니다link:node-container-migration-requirements.html["노드 컨테이너 마이그레이션 요구 사항"] .
* 가상 호스트를 사용하는 경우 다음을 읽어야 합니다.<<mac_address_cloning_ubuntu,MAC 주소 복제에 대한 고려 사항 및 권장 사항>> 호스트 네트워크를 구성하기 전에.



NOTE: VM을 호스트로 사용하는 경우 가상 네트워크 어댑터로 VMXNET 3을 선택해야 합니다.  VMware E1000 네트워크 어댑터로 인해 특정 Linux 배포판에 배포된 StorageGRID 컨테이너에서 연결 문제가 발생했습니다.

.이 작업에 관하여
그리드 노드는 그리드 네트워크에 액세스할 수 있어야 하며, 선택적으로 관리자 및 클라이언트 네트워크에도 액세스할 수 있어야 합니다.  각 그리드 노드의 가상 인터페이스에 호스트의 물리적 인터페이스를 연결하는 매핑을 생성하여 이러한 액세스를 제공합니다.  호스트 인터페이스를 생성할 때는 모든 호스트에 배포를 용이하게 하고 마이그레이션을 활성화하기 위해 친숙한 이름을 사용하세요.

동일한 인터페이스는 호스트와 하나 이상의 노드 간에 공유될 수 있습니다.  예를 들어, 호스트 및 노드 유지 관리를 용이하게 하기 위해 호스트 액세스와 노드 관리 네트워크 액세스에 동일한 인터페이스를 사용할 수 있습니다.  호스트와 개별 노드 간에 동일한 인터페이스를 공유할 수 있지만, 모두 서로 다른 IP 주소를 가져야 합니다.  IP 주소는 노드 간 또는 호스트와 노드 간에 공유될 수 없습니다.

호스트의 모든 StorageGRID 노드에 대해 동일한 호스트 네트워크 인터페이스를 사용하여 Grid Network 인터페이스를 제공할 수 있습니다. 각 노드에 대해 다른 호스트 네트워크 인터페이스를 사용할 수도 있고, 그 중간의 작업을 수행할 수도 있습니다.  그러나 일반적으로 단일 노드에 대해 그리드 네트워크 인터페이스와 관리 네트워크 인터페이스로 동일한 호스트 네트워크 인터페이스를 제공하지 않으며, 한 노드에는 그리드 네트워크 인터페이스를 제공하고 다른 노드에는 클라이언트 네트워크 인터페이스를 제공하지 않습니다.

이 작업은 여러 가지 방법으로 완료할 수 있습니다.  예를 들어, 호스트가 가상 머신이고 각 호스트에 대해 하나 또는 두 개의 StorageGRID 노드를 배포하는 경우 하이퍼바이저에서 올바른 수의 네트워크 인터페이스를 만들고 1:1 매핑을 사용할 수 있습니다.  프로덕션 용도로 베어 메탈 호스트에 여러 노드를 배포하는 경우, 장애 허용 및 대역폭 공유를 위해 VLAN 및 LACP에 대한 Linux 네트워킹 스택 지원을 활용할 수 있습니다.  다음 섹션에서는 두 가지 예에 대한 자세한 접근 방식을 제공합니다.  이 두 가지 예를 모두 사용할 필요는 없습니다. 귀하의 필요에 맞는 어떤 접근 방식이라도 사용하면 됩니다.


NOTE: 본드 또는 브리지 장치를 컨테이너 네트워크 인터페이스로 직접 사용하지 마세요.  그렇게 하면 컨테이너 네임스페이스에서 본드 및 브리지 장치를 사용하여 MACVLAN을 사용할 때 발생하는 커널 문제로 인한 노드 시작을 방지할 수 있습니다.  대신 VLAN이나 가상 이더넷(veth) 쌍과 같은 비결합 장치를 사용하세요.  노드 구성 파일에서 이 장치를 네트워크 인터페이스로 지정합니다.



== MAC 주소 복제에 대한 고려 사항 및 권장 사항

.[[mac_address_cloning_ubuntu]]
MAC 주소 복제를 사용하면 컨테이너가 호스트의 MAC 주소를 사용하고, 호스트는 사용자가 지정한 주소나 무작위로 생성된 주소의 MAC 주소를 사용합니다.  무작위 모드 네트워크 구성 사용을 방지하려면 MAC 주소 복제를 사용해야 합니다.



=== MAC 복제 활성화

특정 환경에서는 MAC 주소 복제를 통해 보안을 강화할 수 있습니다. 관리 네트워크, 그리드 네트워크, 클라이언트 네트워크에 전용 가상 NIC를 사용할 수 있기 때문입니다.  컨테이너가 호스트의 전용 NIC의 MAC 주소를 사용하면 무차별 모드 네트워크 구성을 사용하지 않아도 됩니다.


NOTE: MAC 주소 복제는 가상 서버 설치와 함께 사용하도록 설계되었으며 모든 물리적 어플라이언스 구성에서 제대로 작동하지 않을 수 있습니다.


NOTE: MAC 복제 대상 인터페이스가 사용 중이어서 노드가 시작되지 않는 경우, 노드를 시작하기 전에 링크를 "다운"으로 설정해야 할 수도 있습니다.  또한 가상 환경으로 인해 링크가 연결된 동안 네트워크 인터페이스에서 MAC 복제가 차단될 수도 있습니다.  인터페이스가 사용 중이어서 노드가 MAC 주소를 설정하고 시작하는 데 실패하는 경우, 노드를 시작하기 전에 링크를 "다운"으로 설정하면 문제가 해결될 수 있습니다.

MAC 주소 복제는 기본적으로 비활성화되어 있으며 노드 구성 키로 설정해야 합니다.  StorageGRID 설치할 때 이 기능을 활성화해야 합니다.

각 네트워크마다 하나의 키가 있습니다.

* `ADMIN_NETWORK_TARGET_TYPE_INTERFACE_CLONE_MAC`
* `GRID_NETWORK_TARGET_TYPE_INTERFACE_CLONE_MAC`
* `CLIENT_NETWORK_TARGET_TYPE_INTERFACE_CLONE_MAC`


키를 "true"로 설정하면 컨테이너가 호스트 NIC의 MAC 주소를 사용합니다.  또한 호스트는 지정된 컨테이너 네트워크의 MAC 주소를 사용합니다.  기본적으로 컨테이너 주소는 무작위로 생성된 주소이지만 다음을 사용하여 설정한 경우 `_NETWORK_MAC` 노드 구성 키의 경우 해당 주소가 대신 사용됩니다.  호스트와 컨테이너는 항상 다른 MAC 주소를 갖습니다.


NOTE: 하이퍼바이저에서 무차별 모드를 활성화하지 않고 가상 호스트에서 MAC 복제를 활성화하면 호스트 인터페이스를 사용하는 Linux 호스트 네트워킹이 작동을 멈출 수 있습니다.



=== MAC 클로닝 사용 사례

MAC 복제에는 두 가지 사용 사례를 고려해야 합니다.

* MAC 복제가 활성화되지 않음: `_CLONE_MAC` 노드 구성 파일의 키가 설정되지 않았거나 "false"로 설정된 경우 호스트는 호스트 NIC MAC을 사용하고 컨테이너는 MAC이 지정되지 않는 한 StorageGRID 에서 생성된 MAC을 갖습니다. `_NETWORK_MAC` 열쇠.  주소가 설정된 경우 `_NETWORK_MAC` 키, 컨테이너에는 지정된 주소가 있습니다. `_NETWORK_MAC` 열쇠.  이러한 키 구성에는 무차별 모드를 사용해야 합니다.
* MAC 복제가 활성화된 경우: `_CLONE_MAC` 노드 구성 파일의 키가 "true"로 설정되어 있고 컨테이너가 호스트 NIC MAC을 사용하고 호스트가 StorageGRID 에서 생성된 MAC을 사용하는 경우(MAC이 지정되지 않은 경우) `_NETWORK_MAC` 열쇠.  주소가 설정된 경우 `_NETWORK_MAC` 키를 사용하면 호스트는 생성된 주소 대신 지정된 주소를 사용합니다.  이러한 키 구성에서는 무차별 모드를 사용하면 안 됩니다.



NOTE: MAC 주소 복제를 사용하지 않고 하이퍼바이저에서 할당한 MAC 주소 이외의 MAC 주소에 대한 데이터를 모든 인터페이스에서 수신 및 전송하도록 허용하려면 가상 스위치 및 포트 그룹 수준의 보안 속성이 무작위 모드, MAC 주소 변경 및 위조 전송에 대해 *수락*으로 설정되어 있는지 확인하세요.  가상 스위치에 설정된 값은 포트 그룹 수준의 값으로 재정의될 수 있으므로 두 곳의 설정이 동일한지 확인하세요.

MAC 복제를 활성화하려면 다음을 참조하세요.link:creating-node-configuration-files.html["노드 구성 파일을 만드는 방법"] .



=== MAC 클로닝 예제

인터페이스 ens256에 대해 MAC 주소가 11:22:33:44:55:66이고 노드 구성 파일에 다음 키가 있는 호스트에서 MAC 복제가 활성화된 예:

* `ADMIN_NETWORK_TARGET = ens256`
* `ADMIN_NETWORK_MAC = b2:9c:02:c2:27:10`
* `ADMIN_NETWORK_TARGET_TYPE_INTERFACE_CLONE_MAC = true`


결과: ens256의 호스트 MAC은 b2:9c:02:c2:27:10이고 관리 네트워크 MAC은 11:22:33:44:55:66입니다.



== 예 1: 물리적 또는 가상 NIC에 대한 1대1 매핑

예제 1에서는 호스트 측 구성이 거의 또는 전혀 필요하지 않은 간단한 물리적 인터페이스 매핑을 설명합니다.

image::../media/rhel_install_vlan_diag_1.gif[VLAN 다이어그램]

Linux 운영 체제는 설치 또는 부팅 중, 또는 인터페이스가 핫 애드될 때 ensXYZ 인터페이스를 자동으로 생성합니다. 부팅 후 인터페이스가 자동으로 실행되도록 설정하는 것 외에는 다른 구성이 필요하지 않습니다. 나중에 구성 프로세스에서 올바른 매핑을 제공할 수 있도록 어떤 ensXYZ가 어떤 StorageGRID 네트워크(Grid, Admin 또는 Client)에 해당하는지 확인해야 합니다.

그림에서는 여러 개의 StorageGRID 노드가 표시되어 있지만 일반적으로 이 구성은 단일 노드 VM에 사용됩니다.

스위치 1이 물리적 스위치인 경우, 인터페이스 10G~1~ ~ 10G~3~에 연결된 포트를 액세스 모드로 구성하고 적절한 VLAN에 배치해야 합니다.



== 예 2: VLAN을 전달하는 LACP 본드

예제 2에서는 사용자가 Linux 배포판에서 네트워크 인터페이스 본딩과 VLAN 인터페이스 생성에 익숙하다고 가정합니다.

.이 작업에 관하여
예제 2에서는 단일 호스트의 모든 노드에서 사용 가능한 모든 네트워크 대역폭을 공유할 수 있도록 하는 일반적이고 유연한 VLAN 기반 방식을 설명합니다.  이 예는 베어 메탈 호스트에 특히 적용 가능합니다.

이 예를 이해하려면 각 데이터 센터에 그리드, 관리자, 클라이언트 네트워크에 대한 세 개의 별도 서브넷이 있다고 가정해 보겠습니다.  서브넷은 별도의 VLAN(1001, 1002, 1003)에 있으며 LACP 본딩 트렁크 포트(bond0)에서 호스트에 표시됩니다.  본드에 bond0.1001, bond0.1002, bond0.1003의 세 개의 VLAN 인터페이스를 구성합니다.

동일한 호스트의 노드 네트워크에 대해 별도의 VLAN과 서브넷이 필요한 경우, 본드에 VLAN 인터페이스를 추가하고 이를 호스트에 매핑할 수 있습니다(그림에서 bond0.1004로 표시).

image::../media/rhel_install_vlan_diag_2.gif[이 이미지는 주변 텍스트로 설명됩니다.]

.단계
. StorageGRID 네트워크 연결에 사용될 모든 물리적 네트워크 인터페이스를 단일 LACP 본드로 집계합니다.
+
모든 호스트에서 본드에 동일한 이름을 사용합니다(예: bond0).

. 표준 VLAN 인터페이스 명명 규칙을 사용하여 이 본드를 연관된 "물리적 장치"로 사용하는 VLAN 인터페이스를 만듭니다. `physdev-name.VLAN ID` .
+
1단계와 2단계에서는 네트워크 링크의 다른 쪽 끝을 종료하는 에지 스위치에서 적절한 구성이 필요합니다.  에지 스위치 포트도 LACP 포트 채널로 집계되어야 하며, 트렁크로 구성되어야 하며, 모든 필수 VLAN을 통과할 수 있어야 합니다.

+
이 호스트별 네트워킹 구성 방식에 대한 예시 인터페이스 구성 파일이 제공됩니다.



.관련 정보
link:example-etc-network-interfaces.html["예제 /etc/network/interfaces"]
