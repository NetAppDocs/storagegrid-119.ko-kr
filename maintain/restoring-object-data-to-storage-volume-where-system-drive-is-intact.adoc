---
permalink: maintain/restoring-object-data-to-storage-volume-where-system-drive-is-intact.html 
sidebar: sidebar 
keywords: restore replicated data, restore erasure-coded data, recover storage node, recover storage volume 
summary: 시스템 드라이브가 손상되지 않은 스토리지 노드에서 스토리지 볼륨을 복구한 후, 스토리지 볼륨에 오류가 발생했을 때 손실된 복제되거나 삭제된 개체 데이터를 복원할 수 있습니다. 
---
= 시스템 드라이브가 손상되지 않은 스토리지 볼륨에 개체 데이터를 복원합니다.
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
시스템 드라이브가 손상되지 않은 스토리지 노드에서 스토리지 볼륨을 복구한 후, 스토리지 볼륨에 오류가 발생했을 때 손실된 복제되거나 삭제된 개체 데이터를 복원할 수 있습니다.



== 어떤 절차를 사용해야 하나요?

가능하다면 그리드 관리자의 *볼륨 복원* 페이지를 사용하여 개체 데이터를 복원하세요.

* 볼륨이 *유지 관리* > *볼륨 복원* > *복원할 노드*에 나열된 경우 다음을 사용하여 개체 데이터를 복원합니다.link:../maintain/restoring-volume.html["그리드 관리자의 볼륨 복원 페이지"] .
* 볼륨이 *유지 관리* > *볼륨 복원* > *복원할 노드*에 나열되지 않은 경우 아래 단계에 따라 사용하십시오. `repair-data` 객체 데이터를 복원하는 스크립트입니다.
+
복구된 스토리지 노드에 교체하려는 노드보다 볼륨이 적은 경우 다음을 사용해야 합니다. `repair-data` 스크립트.




NOTE: repair-data 스크립트는 더 이상 사용되지 않으며 향후 릴리스에서 제거될 예정입니다.  가능하면 다음을 사용하세요.link:../maintain/restoring-volume.html["Grid Manager의 볼륨 복원 절차"] .



== 사용하다 `repair-data` 객체 데이터를 복원하는 스크립트

.시작하기 전에
* 복구된 스토리지 노드의 연결 상태가 *연결됨*임을 확인했습니다.image:../media/icon_alert_green_checkmark.png["아이콘 경고 녹색 확인 표시"] 그리드 관리자의 *노드* > *개요* 탭.


.이 작업에 관하여
그리드의 ILM 규칙이 개체 복사본을 사용할 수 있도록 구성되어 있다고 가정하면, 다른 스토리지 노드나 클라우드 스토리지 풀에서 개체 데이터를 복원할 수 있습니다.

다음 사항에 유의하세요.

* ILM 규칙이 복제된 복사본을 하나만 저장하도록 구성되었고 해당 복사본이 실패한 스토리지 볼륨에 있는 경우 해당 개체를 복구할 수 없습니다.
* 객체의 유일한 남은 사본이 Cloud Storage Pool에 있는 경우 StorageGRID 객체 데이터를 복원하기 위해 Cloud Storage Pool 엔드포인트에 여러 요청을 발행해야 합니다.  이 절차를 수행하기 전에 기술 지원팀에 문의하여 복구 기간과 관련 비용을 추산하는 데 도움을 받으세요.




== 에 대하여 `repair-data` 스크립트

개체 데이터를 복원하려면 다음을 실행합니다. `repair-data` 스크립트.  이 스크립트는 개체 데이터 복원 프로세스를 시작하고 ILM 스캐닝과 함께 작동하여 ILM 규칙이 충족되는지 확인합니다.

아래에서 *복제된 데이터* 또는 *삭제 코드화(EC) 데이터*를 선택하여 다양한 옵션을 알아보세요. `repair-data` 복제된 데이터를 복원하는지 아니면 삭제된 데이터를 복원하는지에 따라 스크립트가 달라집니다.  두 가지 유형의 데이터를 모두 복원해야 하는 경우 두 명령 세트를 모두 실행해야 합니다.


NOTE: 자세한 내용은 `repair-data` 스크립트, 입력 `repair-data --help` 기본 관리 노드의 명령줄에서.


NOTE: repair-data 스크립트는 더 이상 사용되지 않으며 향후 릴리스에서 제거될 예정입니다.  가능하면 다음을 사용하세요.link:../maintain/restoring-volume.html["Grid Manager의 볼륨 복원 절차"] .

[role="tabbed-block"]
====
.복제된 데이터
--
복제된 데이터를 복원하는 데 사용할 수 있는 명령은 두 가지입니다. 이는 전체 노드를 복구해야 하는지 아니면 노드의 특정 볼륨만 복구해야 하는지에 따라 달라집니다.

`repair-data start-replicated-node-repair`

`repair-data start-replicated-volume-repair`

다음 명령을 사용하면 복제된 데이터의 복구를 추적할 수 있습니다.

`repair-data show-replicated-repair-status`

--
.삭제 코드(EC) 데이터
--
삭제된 데이터를 복원하기 위해 두 가지 명령을 사용할 수 있습니다. 이는 전체 노드를 복구해야 하는지 아니면 노드의 특정 볼륨만 복구해야 하는지에 따라 달라집니다.

`repair-data start-ec-node-repair`

`repair-data start-ec-volume-repair`

다음 명령을 사용하면 삭제된 데이터의 복구를 추적할 수 있습니다.

`repair-data show-ec-repair-status`


NOTE: 삭제된 데이터의 복구는 일부 스토리지 노드가 오프라인 상태인 동안에도 시작될 수 있습니다.  그러나 삭제된 모든 데이터를 설명할 수 없는 경우 복구를 완료할 수 없습니다.  모든 노드를 사용할 수 있게 되면 복구가 완료됩니다.


NOTE: EC 수리 작업은 일시적으로 많은 양의 저장 공간을 예약합니다.  저장 공간 알림이 발생할 수 있지만, 수리가 완료되면 해결됩니다.  예약에 필요한 저장 공간이 충분하지 않으면 EC 복구 작업이 실패합니다.  EC 복구 작업이 완료되면 작업이 실패했든 성공했든 스토리지 예약이 해제됩니다.

--
====


== 스토리지 노드의 호스트 이름 찾기

. 기본 관리 노드에 로그인합니다.
+
.. 다음 명령을 입력하세요: `ssh admin@_primary_Admin_Node_IP_`
.. 나열된 비밀번호를 입력하세요 `Passwords.txt` 파일.
.. 다음 명령을 입력하여 루트로 전환하세요. `su -`
.. 나열된 비밀번호를 입력하세요 `Passwords.txt` 파일.
+
루트로 로그인하면 프롬프트가 다음과 같이 변경됩니다. `$` 에게 `#` .



. 사용하다 `/etc/hosts` 복구된 스토리지 볼륨에 대한 스토리지 노드의 호스트 이름을 찾으려면 파일을 사용합니다.  그리드의 모든 노드 목록을 보려면 다음을 입력하세요. `cat /etc/hosts` .




== 모든 볼륨이 실패한 경우 데이터 복구

모든 스토리지 볼륨에 오류가 발생한 경우 전체 노드를 복구합니다.  복제된 데이터, 삭제 코딩된(EC) 데이터 또는 둘 다를 사용하는지 여부에 따라 *복제된 데이터*, *삭제 코딩된(EC) 데이터* 또는 둘 다에 대한 지침을 따르세요.

일부 볼륨만 실패한 경우 다음으로 이동하세요.<<일부 볼륨만 실패한 경우 데이터 복구>> .


NOTE: 당신은 달릴 수 없습니다 `repair-data` 동시에 여러 노드에 대한 작업을 수행합니다.  여러 노드를 복구하려면 기술 지원팀에 문의하세요.

[role="tabbed-block"]
====
.복제된 데이터
--
그리드에 복제된 데이터가 포함되어 있는 경우 다음을 사용하세요. `repair-data start-replicated-node-repair` 명령으로 `--nodes` 옵션, 여기서 `--nodes` 전체 스토리지 노드를 복구하기 위한 호스트 이름(시스템 이름)입니다.

이 명령은 SG-DC-SN3이라는 스토리지 노드에서 복제된 데이터를 복구합니다.

`repair-data start-replicated-node-repair --nodes SG-DC-SN3`


NOTE: 개체 데이터가 복원되면 StorageGRID 시스템이 복제된 개체 데이터를 찾을 수 없는 경우 *개체 손실* 경고가 트리거됩니다. 시스템 전체의 스토리지 노드에서 경고가 발생할 수 있습니다. 손실의 원인을 파악하고 회복이 가능한지 확인해야 합니다. 보다 link:../troubleshoot/investigating-lost-objects.html["분실물을 조사하세요"] .

--
.삭제 코드(EC) 데이터
--
그리드에 삭제 코드 데이터가 포함되어 있는 경우 다음을 사용하세요. `repair-data start-ec-node-repair` 명령으로 `--nodes` 옵션, 여기서 `--nodes` 전체 스토리지 노드를 복구하기 위한 호스트 이름(시스템 이름)입니다.

이 명령은 SG-DC-SN3이라는 스토리지 노드에서 삭제된 데이터를 복구합니다.

`repair-data start-ec-node-repair --nodes SG-DC-SN3`

이 작업은 고유한 값을 반환합니다. `repair ID` 이것을 식별하는 `repair_data` 작업.  이것을 사용하세요 `repair ID` 진행 상황과 결과를 추적하려면 `repair_data` 작업.  복구 프로세스가 완료되면 다른 피드백은 반환되지 않습니다.

삭제된 데이터의 복구는 일부 스토리지 노드가 오프라인 상태인 동안에도 시작될 수 있습니다.  모든 노드를 사용할 수 있게 되면 복구가 완료됩니다.

--
====


== 일부 볼륨만 실패한 경우 데이터 복구

일부 볼륨만 실패한 경우 영향을 받은 볼륨을 복구합니다.  복제된 데이터, 삭제 코딩된(EC) 데이터 또는 둘 다를 사용하는지 여부에 따라 *복제된 데이터*, *삭제 코딩된(EC) 데이터* 또는 둘 다에 대한 지침을 따르세요.

모든 볼륨이 실패한 경우 다음으로 이동하세요.<<모든 볼륨이 실패한 경우 데이터 복구>> .

볼륨 ID를 16진수로 입력하세요.  예를 들어, `0000` 첫 번째 볼륨이고 `000F` 16번째 권입니다.  하나의 볼륨, 볼륨 범위 또는 순서에 속하지 않는 여러 볼륨을 지정할 수 있습니다.

모든 볼륨은 동일한 스토리지 노드에 있어야 합니다.  두 개 이상의 스토리지 노드에 대한 볼륨을 복원해야 하는 경우 기술 지원팀에 문의하세요.

[role="tabbed-block"]
====
.복제된 데이터
--
그리드에 복제된 데이터가 포함되어 있는 경우 다음을 사용하세요. `start-replicated-volume-repair` 명령으로 `--nodes` 노드를 식별하는 옵션(여기서 `--nodes` (노드의 호스트 이름입니다).  그런 다음 다음 중 하나를 추가하세요. `--volumes` 또는 `--volume-range` 다음 예에서 볼 수 있듯이 옵션입니다.

*단일 볼륨*: 이 명령은 복제된 데이터를 볼륨으로 복원합니다. `0002` SG-DC-SN3이라는 스토리지 노드에서:

`repair-data start-replicated-volume-repair --nodes SG-DC-SN3 --volumes 0002`

*볼륨 범위*: 이 명령은 범위 내의 모든 볼륨에 복제된 데이터를 복원합니다. `0003` 에게 `0009` SG-DC-SN3이라는 스토리지 노드에서:

`repair-data start-replicated-volume-repair --nodes SG-DC-SN3 --volume-range 0003,0009`

*순서가 아닌 여러 볼륨*: 이 명령은 복제된 데이터를 볼륨으로 복원합니다. `0001` , `0005` , 그리고 `0008` SG-DC-SN3이라는 스토리지 노드에서:

`repair-data start-replicated-volume-repair --nodes SG-DC-SN3 --volumes 0001,0005,0008`


NOTE: 개체 데이터가 복원되면 StorageGRID 시스템이 복제된 개체 데이터를 찾을 수 없는 경우 *개체 손실* 경고가 트리거됩니다. 시스템 전체의 스토리지 노드에서 경고가 발생할 수 있습니다. 손실 원인을 파악하고 복구가 가능한지 확인하려면 알림 설명과 권장 조치를 확인하세요.

--
.삭제 코드(EC) 데이터
--
그리드에 삭제 코드 데이터가 포함되어 있는 경우 다음을 사용하세요. `start-ec-volume-repair` 명령으로 `--nodes` 노드를 식별하는 옵션(여기서 `--nodes` (노드의 호스트 이름입니다).  그런 다음 다음 중 하나를 추가하세요. `--volumes` 또는 `--volume-range` 다음 예에서 볼 수 있듯이 옵션입니다.

*단일 볼륨*: 이 명령은 삭제된 데이터를 볼륨으로 복원합니다. `0007` SG-DC-SN3이라는 스토리지 노드에서:

`repair-data start-ec-volume-repair --nodes SG-DC-SN3 --volumes 0007`

*볼륨 범위*: 이 명령은 범위 내의 모든 볼륨에 삭제 코딩된 데이터를 복원합니다. `0004` 에게 `0006` SG-DC-SN3이라는 스토리지 노드에서:

`repair-data start-ec-volume-repair --nodes SG-DC-SN3 --volume-range 0004,0006`

*순서가 없는 여러 볼륨*: 이 명령은 삭제된 데이터를 볼륨으로 복원합니다. `000A` , `000C` , 그리고 `000E` SG-DC-SN3이라는 스토리지 노드에서:

`repair-data start-ec-volume-repair --nodes SG-DC-SN3 --volumes 000A,000C,000E`

그만큼 `repair-data` 작업은 고유한 값을 반환합니다. `repair ID` 이것을 식별하는 `repair_data` 작업.  이것을 사용하세요 `repair ID` 진행 상황과 결과를 추적하려면 `repair_data` 작업.  복구 프로세스가 완료되면 다른 피드백은 반환되지 않습니다.


NOTE: 삭제된 데이터의 복구는 일부 스토리지 노드가 오프라인 상태인 동안에도 시작될 수 있습니다.  모든 노드를 사용할 수 있게 되면 복구가 완료됩니다.

--
====


== 모니터 수리

*복제된 데이터*, *삭제 코드(EC) 데이터* 또는 둘 다를 사용하는지 여부에 따라 수리 작업 상태를 모니터링합니다.

진행 중인 볼륨 복원 작업의 상태를 모니터링하고 완료된 복원 작업의 기록을 볼 수도 있습니다.link:../maintain/restoring-volume.html["그리드 관리자"] .

[role="tabbed-block"]
====
.복제된 데이터
--
* 복제된 수리에 대한 예상 완료율을 얻으려면 다음을 추가합니다. `show-replicated-repair-status` repair-data 명령에 대한 옵션입니다.
+
`repair-data show-replicated-repair-status`

* 수리가 완료되었는지 확인하려면:
+
.. *노드* > *_수리 중인 스토리지 노드_* > *ILM*을 선택합니다.
.. 평가 섹션에서 속성을 검토하세요.  수리가 완료되면 *대기 - 모두* 속성은 0개의 객체를 나타냅니다.


* 수리 과정을 더 자세히 모니터링하려면:
+
.. *지원* > *도구* > *그리드 토폴로지*를 선택하세요.
.. *_grid_* > *_수리 중인 스토리지 노드_* > *LDR* > *데이터 저장소*를 선택합니다.
.. 다음 속성을 조합하여 복제된 수리가 완료되었는지 가능한 한 정확하게 확인합니다.
+

NOTE: 카산드라 불일치가 존재할 수 있으며, 실패한 수리는 추적되지 않습니다.

+
*** *시도된 수리(XRPA)*: 이 속성을 사용하여 복제된 수리의 진행 상황을 추적합니다.  이 속성은 스토리지 노드가 고위험 객체를 복구하려고 할 때마다 증가합니다.  이 속성이 현재 스캔 기간(스캔 기간 - 추정* 속성에서 제공)보다 더 오랫동안 증가하지 않으면 ILM 스캔에서 어떤 노드에서도 복구가 필요한 고위험 개체를 찾지 못했음을 의미합니다.
+

NOTE: 고위험 물건은 완전히 분실될 위험이 있는 물건입니다.  여기에는 ILM 구성을 충족하지 못하는 객체는 포함되지 않습니다.

*** *스캔 기간 - 추정(XSCM)*: 이 속성을 사용하여 이전에 수집된 개체에 정책 변경이 적용되는 시기를 추정합니다.  *시도된 복구* 속성이 현재 스캔 기간보다 더 오랫동안 증가하지 않으면 복제된 복구가 수행되었을 가능성이 높습니다.  검사 기간은 변경될 수 있습니다.  *스캔 기간 - 추정(XSCM)* 속성은 전체 그리드에 적용되며 모든 노드 스캔 기간의 최대값입니다.  그리드의 *스캔 기간 - 예상* 속성 기록을 쿼리하여 적절한 기간을 결정할 수 있습니다.






--
.삭제 코드(EC) 데이터
--
삭제된 데이터의 복구를 모니터링하고 실패했을 수 있는 요청을 다시 시도하려면 다음을 수행합니다.

. 삭제된 데이터 복구 상태를 확인합니다.
+
** *지원* > *도구* > *측정항목*을 선택하면 현재 작업의 예상 완료 시간과 완료율을 볼 수 있습니다. 그런 다음 Grafana 섹션에서 *EC 개요*를 선택합니다. *Grid EC 작업 예상 완료 시간* 및 *Grid EC 작업 완료율* 대시보드를 살펴보세요.
** 이 명령을 사용하여 특정 상태를 확인하세요. `repair-data` 작업:
+
`repair-data show-ec-repair-status --repair-id repair ID`

** 이 명령을 사용하여 모든 수리 내용을 나열합니다.
+
`repair-data show-ec-repair-status`

+
출력에는 다음 정보가 나열됩니다. `repair ID` , 이전에 진행 중이거나 현재 진행 중인 모든 수리에 대해.



. 출력에 수리 작업이 실패한 것으로 표시되면 다음을 사용하십시오. `--repair-id` 수리를 다시 시도하는 옵션입니다.
+
이 명령은 복구 ID 6949309319275667690을 사용하여 실패한 노드 복구를 다시 시도합니다.

+
`repair-data start-ec-node-repair --repair-id 6949309319275667690`

+
이 명령은 복구 ID 6949309319275667690을 사용하여 실패한 볼륨 복구를 다시 시도합니다.

+
`repair-data start-ec-volume-repair --repair-id 6949309319275667690`



--
====